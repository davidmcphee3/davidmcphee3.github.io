<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<title>David McPhee's Personal Homepage</title>
<link href="/includes/main.css" rel="stylesheet" type="text/css" media="screen" />

</head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C8K8BK48K1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C8K8BK48K1');
</script>

<body style="background-color:#121212;">

<div id="content">

<div id="nav">
<ul>
<li><a href="/other.html">Back To Other</a></li>
</ul>
</div>

<!-- End Header $include_path/header.html -->

<div class="main">
<div class="bTitle"><p><u><strong>The Gambler's Ruin</strong></u><p /></div>
<img class="bImg" src="/includes/other/gamblersruin/thumbnail.png" alt="Thumbnail for The Gambler's Ruin"></img>
The Gambler's Ruin is a statistical concept that is used to prove the security of Bitcoin and other
blockchain-based technologies. This concept lacks explanation and proof in the Bitcoin whitepaper which is the inspiration for
this project. The thumbnail graph and equation will be fully explored to prove the validity and clear ambiguities.
<div class="bSub"><p><b>The Motivation</b><p /></div>
Whilst reading the <a href="https://davidmcphee.ca/includes/projects/cryptominer/bitcoinwhitepaper.pdf">Bitcoin Whitepaper</a>,
there was a section that involved proving the security of the blockchain. The blockchain is maintained by nodes (CPUs, computers, etc)
and the author of the paper claims that so long as more than 51% of the nodes are honest, the blockchain is secure. The paper compares
this to the Gambler's Ruin and shows the equation in the thumbnail with no other proof. For clarity, in
<a href="https://davidmcphee.ca/cryptominer.html">this project</a> I created and provided a plot of the equation. For me this
actually made things more confusing and I spent a couple of nights awake thinking about it.
<div class="bSub"><p><b>The Blockchain Problem</b><p /></div>
On the blockchain the longest chain is the accepted chain. Transactions can be altered somewhat by attackers but the catch is that they
have to shorten their chain to make the alteration. Since the altered chain is shorter than the unaltered chain, the altered chain is
considered invalid and none of their altered transactions will be recognized. If they are somehow able to get their chain longer than
the unaltered chain, then their chain becomes the accepted chain and thus they have successful stolen bitcoin.<p />
The blockchain is lengthened by nodes guessing the right answer to a complex problem. For the sake of the this problem, the percentage of
honest nodes is represented by <i>p</i> and the percentage of dishonest nodes <i>q</i>. These definitions imply that (Eq. 1):<p />
<img class="bImg" src="/includes/other/gamblersruin/img1.png" alt="1 = p + q"></img>
We can assume that the attackers are <i>z</i> blocks behind the honest nodes. What is the probability that the attacking nodes will ever
catch up to the honest nodes?
<div class="bSub"><p><b>The Gambler's Ruin Problem</b><p /></div>
The Gambler's Ruin is a concept that states that a gambler starts with 1 penny and on each betting round either wins or loses a penny.
The gambler is betting on a weighted coin flip and bets heads every time. This means that there is a <i>r</i> chance it lands on heads
and a <i>s</i> chance it lands on tails. This implies:
<img class="bImg" src="/includes/other/gamblersruin/img2.png" alt="1 = r + s"></img>
What are the odds that the gambler attains a fortune of <i>N</i> pennies before getting ruined (i.e going broke)?
<div class="bSub"><p><b>Bitcoin x Gambler's Ruin</b><p /></div>
These two statistical events seem related but the differences are important. In the blockchain example, the attacker is at a deficit of blocks
relative to the honest nodes and is trying to get to a zero block deficit. This is the opposite of the gambler who starts at a surplus and is
trying <i>not</i> to reach 0 pennies. With each example there is also the other perspective. In the blockchain example the honest nodes are
trying to be an infinite number of blocks ahead of the attackers before the attackers catch up. This perspective sounds a lot more like the
gambler. OK, so the gambler and the honest nodes are the same, for now let's assume that the honest nodes only need to get <i>N</i> blocks
ahead of the attackers.<p />
The blockchain problem can now be thought of as a weighted coin-flip where again <i>p</i> is the weight of the side that the honest nodes pick and
<i>q</i> is the weight of the side that the attackers pick. For simplicity let's assume the honest nodes always pick heads and dishonest nodes
always pick tails. The honest nodes start <i>z</i> blocks ahead of the dishonest nodes and are trying to reach <i>N</i> nodes ahead before the
attackers catch up.<p />
Now lets fully define the problem with more general variables.<br> What is the probability that the honest nodes will get <i>N</i> blocks ahead of
the dishonest nodes using a weighted coin with weight <i>p</i> for the honest nodes and <i>q</i> for the dishonest nodes? Assume that the honest
nodes start <i>z</i> blocks ahead of the dishonest nodes. By definition of a coin flip, <i>1 = q + p</i>. <i>0 < z < N</i> because either the
attackers have caught up if <i>z = 0</i> or the honest nodes have gotten far enough way when <i>z = N</i><p />
<div class="sText"><p>Note: To clear up any confusion, <i>p</i> and <i>q</i> are probabilities which means they can be thought of as a percentage or
a decimal. In the case of percentage, the equation is <i>100% = q + p</i>.</div><p />
<i>P<sub>z</sub></i> is the probability that the honest nodes will reach <i>N</i> blocks ahead before the attackers catch up. If
<i>z = 0</i> then the attackers have caught up and the honest nodes lose <i>P<sub>0</sub> = 0</i>. If <i>z = N</i> then the honest have gotten
sufficiently far away and won <i>P<sub>N</sub> = 1</i> (Remember 0 = 0% and 1 = 100% in this context). Now the tricky part, what is <i>P<sub>z</sub></i>
for the values between 0 and <i>N</i>? In other terms, what is the probability that the honest nodes will get sufficiently far away from the dishonest
nodes before the dishonest nodes catch up if the dishonest nodes start at a block deficit of 1 (or 2 or 3 or ... or N-1)?<p />
<div class="bSub"><p><b>Recursion Derivation</b><p /></div>
Each added block changes the probability that the honest nodes will win (reach <i>N</i> before the dishonest nodes catch up). If they start with a probability
of <i>P<sub>z</sub></i> and create a block, their probability of winning changes to <i>P<sub>z+1</sub></i> and if they lose it changes to <i>P<sub>z-1</sub></i>.
This changing problability based on the total outcomes of all of the previous blocks is called the Markov property. Therefore based on the definitions of
<i>p</i> and <i>q</i> the <i>P<sub>z</sub></i> of any <i>z</i> can be written as (Eq. 2):
<img class="bImg" src="/includes/other/gamblersruin/img3.png" alt="Pz = p*P(z+1) + q*P(z-1)"></img>
This is because there is a <i>p</i> chance of the honest nodes making a block and thus the probability of winning turns to <i>P<sub>z+1</sub></i> and a <i>q</i>
of the dishonest nodes winning a block and thus the probability of winning turns to <i>P<sub>z-1</sub></i>. This equation is recursive which means that it
calls on itself to be solved. It can technically be solved by hand or computaionally but the best method is to remove the recursion.<p />
Because of (Eq. 1), (Eq. 2) can be rewritten as:
<img class="bImg" src="/includes/other/gamblersruin/img4.png" alt="(1)*Pz = p*P(z+1) + q*P(z-1)"></img>
<img class="bImg" src="/includes/other/gamblersruin/img5.png" alt="(p + q)*Pz = p*P(z+1) + q*P(z-1)"></img>
<img class="bImg" src="/includes/other/gamblersruin/img5.png" alt="p*Pz + q*Pz = p*P(z+1) + q*P(z-1)"></img>
<img class="bImg" src="/includes/other/gamblersruin/img6.png" alt="P(z+1) - Pz = (q/p)*(Pz - P(z-1))"></img>
Lets solve for <i>z</i> = 1.
<img class="bImg" src="/includes/other/gamblersruin/img7.png" alt="P(2) - P(1) = (q/p)*(P(1) - P(0))"></img>
Recall that <i>P<sub>0</sub> = 0</i> because the attackers caught up and thus the honest nodes lost. So (Eq. 3)
<img class="bImg" src="/includes/other/gamblersruin/img8.png" alt="P(2) - P(1) = (q/p)*P(1)"></img>
Now lets solve for <i>z</i> = 2.
<img class="bImg" src="/includes/other/gamblersruin/img9.png" alt="P(3) - P(2) = (q/p)*(P(2) - P(1))"></img>
We see a <i>(P<sub>2</sub> - P<sub>1</sub>)</i> term so we can replace it with (Eq. 3) to yield:
<img class="bImg" src="/includes/other/gamblersruin/img10.png" alt="P(3) - P(2) = (q/p)*((q/p)*P(1))"></img>
<img class="bImg" src="/includes/other/gamblersruin/img11.png" alt="P(3) - P(2) = (q/p)^2*P(1))"></img>
If we keep solving for increasing <i>z</i> we can get the general equation so long as <i>0 < z < N</i>:
<img class="bImg" src="/includes/other/gamblersruin/img12.png" alt="P(z+1) - P(z) = (q/p)^z*P(1))"></img>


</div>
<!-- Begin Footer $include_path/footer.html -->
<div id="footer">
<br>
david.mcphee3@gmail.com | not copyrighted, no rights reserved
</div>

</div>

<div id="content">
<!-- begin wwww.htmlcommentbox.com -->
 <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comment Box</a> is loading comments...</div>
 <script type="text/javascript" id="hcb"> /*<!--*/ if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="https://www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24Xk1c2cCSlprFkr2MjLvTb."+"&opts=16662&num=10&ts=1644780820414");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
<style>
#HCB_comment_box textarea{width:50%;
}
#HCB_comment_box{font-family:arial;color:#FFFFFF;background-color:none;}
#HCB_comment_box p.error{border:1px solid red;background-color:#fee}
.hcb-mod b{color:#d34}
#HCB_comment_box textarea,#hcb_form_name,#HCB_comment_box input.text{border:none;border-radius:5px;background-color:#FFFFFF}
#HCB_comment_box .text-blur {color:none;}
#HCB_comment_box blockquote{background-color:#626262;width:50%;padding:10px;border-radius:5px}
#HCB_comment_box .hcb-wrapper-half{display:block;width:50%;float:left;}
#HCB_comment_box .hcb-wrapper{clear:both}
#HCB_comment_box input.text{display:block;width:75%}
#HCB_comment_box input.submit{border-radius: 20px;;background-color:#626262;color:#FFFFFF;font-weight:700;cursor:pointer}
#HCB_comment_box span.home-desc{font-size:10px;opacity:.4}
.hcb-link{color:white;text-decoration:underline}
.hcb-mod i{color:#00008b}

 </style>
<!-- end www.htmlcommentbox.com -->
</div>

</body>
</html>
